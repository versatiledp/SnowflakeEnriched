CREATE OR REPLACE PROCEDURE 
	pr_od_AcademicInstitution_Load (YEAR FLOAT)
RETURNS STRING
LANGUAGE javascript
EXECUTE AS OWNER
AS
$$
var sql_command = `
   INSERT INTO   od_AcademicInstitution 
    (InstitutionIdentifier,
    InstitutionName,
    InstitutionNameAlias,
    StreetAddress,
    City,
    State,
    ZipCode,
    StateCode,
    EconomicAnalysisRegions,
    ChiefAdministrator,
    ChiefAdministratorTitle,
    TelephoneNumber,
    EmployerIdentificationNumber,
    DunBradstreetNumbers,
    PostsecondaryEducationIDNumber,
    TitleIVEligibilityIndicatorCode,
    InstitutionsWebAddress,
    AdmissionsOfficeWebAddress,
    FinancialAidOfficeWebAddress,
    OnlineApplicationWebAddress,
    NetPriceCalculatorWebAddress,
    VeteransMilitaryServiceTuitionPoliciesWebAddress,
    StudentRightAthleteGraduationRateWebAddress,
    DisabilityServicesWebAddress,
    SectorOfInstitution,
    LevelOfInstitution,
    ControlOfInstitution,
    HighestLevelOfOffering,
    UndergraduateOffering,
    GraduateOffering,
    HighestDegreeOffered,
    DegreeGrantingStatus,
    HistoricallyBlackCollegeOrUniversity,
    InstitutionHasHospital,
    InstitutionGrantsMedicalDegree,
    TribalCollege,
    DegreeOfUrbanization,
    InstitutionOpenToGeneralPublic,
    StatusOfInstitution,
    UnitidForMergedSchools,
    YearInstitutionWasDeletedFromIPEDS,
    DateInstitutionClosed,
    InstitutionIsActive,
    PrimarilyPostsecondaryIndicator,
    PostsecondaryInstitutionIndicator,
    PostsecondaryAndTitleIvInstitutionIndicator,
    ReportingMethodForStudentCharges,
    InstitutionalCategory,
    CarnegieClassification2015UndergraduateProgram,
    CarnegieClassification2015GraduateProgram,
    CarnegieClassification2015UndergraduateProfile,
    CarnegieClassification2015EnrollmentProfile,
    CarnegieClassification2015SizeSetting,
    CarnegieClassification2015Basic,
    CarnegieClassification20052010Basic,
    CarnegieClassification2000,
    LandGrantInstitution,
    InstitutionSizeCategory,
    MultiCampusOrganization,
    NameOfMultiCampusOrganization,
    IdentificationNumberOfMultiCampusOrganization,
    CoreBasedStatisticalArea,
    CBSATypeMetropolitanMicropolitan,
    CombinedStatisticalArea,
    NewEnglandCityAndTownArea,
    FIPSCountyCode,
    CountyName,
    StateAnd114thCongressionalDistrictID,
    LongitudeLocation,
    LatitudeLocation,
    NCESGroupCategory,
    DataFeedbackReport,
    AcademicYear,
    IngestedFileName,
    RowNumber  )
	SELECT
	  InstitutionIdentifier,
	  InstitutionName,
	  InstitutionNameAlias,
	  StreetAddress,
	  City,
	  State,
	  ZipCode,
	  StateCode,
	  EconomicAnalysisRegions,
	  ChiefAdministrator,
	  ChiefAdministratorTitle,
	  TelephoneNumber,
	  EmployerIdentificationNumber,
	  DunBradstreetNumbers,
	  PostsecondaryEducationIDNumber,
	  TitleIVEligibilityIndicatorCode,
	  InstitutionsWebAddress,
	  AdmissionsOfficeWebAddress,
	  FinancialAidOfficeWebAddress,
	  OnlineApplicationWebAddress,
	  NetPriceCalculatorWebAddress,
	  VeteransMilitaryServiceTuitionPoliciesWebAddress,
	  StudentRightAthleteGraduationRateWebAddress,
	  DisabilityServicesWebAddress,
	  SectorOfInstitution,
	  LevelOfInstitution,
	  ControlOfInstitution,
	  HighestLevelOfOffering,
	  UndergraduateOffering,
	  GraduateOffering,
	  HighestDegreeOffered,
	  DegreeGrantingStatus,
	  HistoricallyBlackCollegeOrUniversity,
	  InstitutionHasHospital,
	  InstitutionGrantsMedicalDegree,
	  TribalCollege,
	  DegreeOfUrbanization,
	  InstitutionOpenToGeneralPublic,
	  StatusOfInstitution,
	  UnitidForMergedSchools,
	  YearInstitutionWasDeletedFromIPEDS,
	  DateInstitutionClosed,
	  InstitutionIsActive,
	  PrimarilyPostsecondaryIndicator,
	  PostsecondaryInstitutionIndicator,
	  PostsecondaryAndTitleIvInstitutionIndicator,
	  ReportingMethodForStudentCharges,
	  InstitutionalCategory,
	  CarnegieClassification2015UndergraduateProgram,
	  CarnegieClassification2015GraduateProgram,
	  CarnegieClassification2015UndergraduateProfile,
	  CarnegieClassification2015EnrollmentProfile,
	  CarnegieClassification2015SizeSetting,
	  CarnegieClassification2015Basic,
	  CarnegieClassification20052010Basic,
	  CarnegieClassification2000,
	  LandGrantInstitution,
	  InstitutionSizeCategory,
	  MultiCampusOrganization,
	  NameOfMultiCampusOrganization,
	  IdentificationNumberOfMultiCampusOrganization,
	  CoreBasedStatisticalArea,
	  CBSATypeMetropolitanMicropolitan,
	  CombinedStatisticalArea,
	  NewEnglandCityAndTownArea,
	  FIPSCountyCode,
	  CountyName,
	  StateAnd114thCongressionalDistrictID,
	  LongitudeLocation,
	  LatitudeLocation,
	  NCESGroupCategory,
	  DataFeedbackReport,
	  AcademicYear,
	  IngestedFileName,
	  RowNumber
	FROM
	  v_od_AcademicInstitution 
    WHERE AcademicYear = ` + YEAR.toString()+`;`

    try {
        snowflake.execute (
          {sqlText: sql_command}
          );
        return "Succeeded.";  // Return a success/error indicator.
        }
    catch (err) {
        return "Failed: " + err;  // Return a success/error indicator.
        }
$$
;
